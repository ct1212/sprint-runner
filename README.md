# Sprint Runner

AI-driven sprint automation using Claude CLI. State a goal, generate a PRD and task list, then let Claude build it task-by-task.

## Prerequisites

- [Claude CLI](https://docs.anthropic.com/en/docs/claude-code) installed and authenticated
- Git repository initialized
- Node.js 18+ (if using the default stack)

## Setup

From your project directory, run:

```bash
bash <(curl -s https://raw.githubusercontent.com/ct1212/sprint-runner/main/setup.sh)
```

Or clone and copy manually:

```bash
git clone https://github.com/ct1212/sprint-runner.git /tmp/sprint-runner
cp -r /tmp/sprint-runner/scripts ./scripts
cp -r /tmp/sprint-runner/sprints ./sprints
chmod +x scripts/sprint_*.sh
rm -rf /tmp/sprint-runner
```

## Quick Start

```bash
# 1. Create a new sprint (will prompt for goal)
./scripts/sprint_new.sh v1

# 2. Edit the goal file — refine acceptance criteria and constraints
# (Leave stack section empty to let Claude choose the best tools for you!)
vi sprints/v1/00-goal.md

# 3. Generate initial PRD — Claude analyzes your goal and picks the optimal stack
./scripts/sprint_prd.sh v1

# 4. Interactively refine the PRD — Claude walks you through each section step-by-step
./scripts/sprint_refine.sh v1
# Claude will ask about each section, help you fill gaps, then generate tasks

# 5. Run tasks one at a time
./scripts/sprint_dev.sh v1

# 6. Or run all tasks automatically in a loop
./scripts/sprint_dev.sh v1 --loop
```

## Scripts

### `sprint_new.sh` — Create a sprint

```bash
./scripts/sprint_new.sh <name>
```

The `<name>` is your sprint identifier (e.g., `v1`, `auth`, `dashboard`). If you don't provide a goal as the second argument, the script will prompt you for it interactively.

Creates `sprints/<name>/` with:

- `00-goal.md` — Goal template to fill in (constraints, acceptance criteria, optional stack)
- `01-prd.md` — Placeholder (generated by sprint_prd)
- `02-tasks.md` — Placeholder (generated by sprint_refine)
- `03-status.md` — Execution log

### `sprint_prd.sh` — Generate initial PRD

```bash
./scripts/sprint_prd.sh <name> [--model sonnet] [--max-budget-usd 2.00]
```

Reads `00-goal.md` and uses Claude to generate an initial PRD with:
- Recommended stack (or confirms your choices)
- Scope, architecture, interfaces, acceptance criteria, risks
- Open questions and assumptions

**Note:** This only generates the PRD, not tasks. Use `sprint_refine.sh` next.

### `sprint_refine.sh` — Interactively refine PRD and generate tasks

```bash
./scripts/sprint_refine.sh <name> [--model sonnet] [--max-budget-usd 3.00]
```

Starts an interactive Claude session that:
- Walks you through each section of the PRD
- Asks clarifying questions
- Helps you add missing details or adjust anything
- Updates the PRD file as you go
- Generates the task checklist when you're satisfied

This is where you collaborate with Claude to ensure the plan is solid before committing to tasks.

### `sprint_dev.sh` — Execute tasks

```bash
./scripts/sprint_dev.sh <name> [--loop] [--dry-run] [--model sonnet] [--max-budget-usd 5.00]
```

| Flag               | Description                             |
| ------------------ | --------------------------------------- |
| `--loop`           | Process all remaining tasks in sequence |
| `--dry-run`        | Show the next task without executing    |
| `--model`          | Claude model to use (default: `sonnet`) |
| `--max-budget-usd` | Per-task spending cap (default: `5.00`) |

Each task runs through: Claude edits files → lint → test → commit. If lint or tests fail, changes are reverted and the failure is logged to `03-status.md`.

## Sprint Directory Structure

```
sprints/
├── README.md          ← overview (optional)
├── v1/
│   ├── 00-goal.md     ← what you want to build
│   ├── 01-prd.md      ← generated PRD
│   ├── 02-tasks.md    ← generated task checklist
│   └── 03-status.md   ← execution log
└── v2/
    └── ...
```

## How It Works

1. **You define the goal** — Write what you want built in `00-goal.md`. Just describe the goal and acceptance criteria—no need to worry about which stack to use!

2. **Claude generates an initial PRD** — `sprint_prd.sh` sends your goal to Claude, which analyzes it and chooses the most appropriate, modern tech stack. It produces a comprehensive PRD with stack rationale, architecture, and acceptance criteria.

3. **Interactive refinement** — `sprint_refine.sh` starts an interactive session where Claude walks you through each section of the PRD, asks clarifying questions, and helps you refine it. Once you're satisfied, Claude generates a checklist of granular tasks.

4. **Claude executes each task** — `sprint_dev.sh` picks the next unchecked task, gives Claude the full context (PRD, task list, project config), and lets it make the code changes.

5. **Automated quality gates** — After each task, the script runs appropriate lint and test commands for your stack. Passing tasks are committed; failing tasks are reverted and logged.

6. **Progress tracking** — Tasks are checked off in `02-tasks.md` and timestamped entries are appended to `03-status.md`.

## Auto Stack Selection

**Don't know what stack to use?** Just describe your goal and let Claude choose!

When you create a sprint, the goal template includes an optional Stack section. If you leave it empty, Claude will:
- Analyze your goal and project requirements
- Choose the most appropriate language and tools (TypeScript/Node.js for APIs, Python for data tasks, Go for CLIs, etc.)
- Select modern, well-supported libraries with good ecosystems
- Explain the rationale in the PRD's "Recommended Stack" section

**Supported stacks:**
- **Node.js/TypeScript** — web apps, APIs, tooling
- **Python** — data processing, ML, scripting, web backends
- **Rust** — performance-critical systems, CLI tools
- **Go** — microservices, CLI tools, networked services

If you have strong preferences, you can still specify the stack in `00-goal.md` and Claude will respect it.

## Extending Stack Support

The scripts automatically detect and support Node.js, Python, Rust, and Go projects. To add support for other stacks:

1. **Add lint/test detection** in `sprint_dev.sh`:
   ```bash
   # Find the LINT_CMD and TEST_CMD sections and add your stack's commands
   elif [[ -f "your-config-file" ]]; then
     LINT_CMD="your-lint-command"
     TEST_CMD="your-test-command"
   ```

2. **Add allowed tools** for your stack's package manager:
   ```bash
   # In sprint_dev.sh, update the --allowedTools list
   "Bash(your-tool:*)"
   ```

3. **Update dependency installation** to detect your stack's config files and install dependencies accordingly.

## Tips

- **Be specific in `00-goal.md`** — the more concrete your acceptance criteria, the better the PRD and tasks
- **Use the interactive refinement** — `sprint_refine.sh` is where you collaborate with Claude to ensure nothing is missing
- **Ask questions during refinement** — Claude will help you think through edge cases, clarify requirements, and make better decisions
- **Review tasks before running dev** — you can still manually edit `02-tasks.md` if needed
- **Use `--dry-run` first** to see what task would execute next
- **Use `--max-budget-usd`** to cap spending on complex tasks
- **Name sprints meaningfully** — use `v1`, `v2` or descriptive names like `auth`, `dashboard`
- **One sprint = one feature area** — keep sprints focused for better results
